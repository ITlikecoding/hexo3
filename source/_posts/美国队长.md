---
title: 美国队长
date: 2018-05-28 12:39:38
tags:
---

#### 题目描述
美国队长为了阻止九头蛇毁灭世界的阴谋，他潜入了九头蛇的总部，要找到作为永恒能量源的宇宙魔方。

宇宙魔方藏在一个 N+1 层楼的顶层的一个保险柜中。

除了顶层外，楼有 N 层，每层有 M 个房间，这 M 个房间围成一圈并按照逆时针方向依次编号为 0,..., M-1 。

其中有一些房间有通向上一层的楼梯，每层楼的楼梯可能在不同的房间里面。

每个房间有一个指示牌，牌上有一个数字 x ，表示从这个房间开始按着逆时针方向选择第 x 个有楼梯的房间（假设这个有楼梯的房间编号为k），从第 k 号房间上楼，上楼后到达上一层的 k 号房间。

比如当前房间的指示牌上写着 2 ，则按逆时针方向开始尝试，找到第 2 个有楼梯的房间，从该房间上楼。

如果该房间本身就有楼梯通向上层，该房间作为第一个有楼梯的房间。

当美国队长到达顶层，他需要输入保险箱的密码，而密码是“每一层第一个进入的房间内指示牌上的数字”的总和。

这个数可能会很大，请输出对 20123 取模的结果即可。

美国队长忙着挥舞盾牌无心计算，请你帮助他算出密码找到宇宙魔方吧。


#### 输入格式
第一行 2 个整数 N 和 M ，之间用一个空格隔开。

N 表示除了顶层外，共 N 层楼，M 表示除顶层外每层楼有 M 个房间。

接下来 N * M 行，每行两个整数，之间用一个空格隔开，每行描述一个房间内的情况。

其中第 (i-1) * M + j 行表示第 i 层 j-1 号房间的情况（i = 1,2,…, N；j=1,2,…,M）。

第一个整数表示该房间是否有楼梯通往上一层（0 表示没有，1 表示有）。

第二个整数表示指示牌上的数字。

注意，从 j 号房间的楼梯爬到上一层到达的房间一定也是 j 号房间。

最后一行，一个整数，表示美国队长从底层的几号房间进入开始搜寻。

房间编号从 0 开始。

#### 输出格式
输出只有一行，一个整数，表示打开宝箱的密钥，请注意对 20123 取模。


#### 样例数据
*input*
```
2 3
1 2
0 3
1 4
0 1
1 5
1 2
1
```

*output*
```
5
```

#### 样例说明
第一层：

0号房间，有楼梯通往上层，指示牌上的数字是2；

1号房间，无楼梯通往上层，指示牌上的数字是3；

2号房间，有楼梯通往上层，指示牌上的数字是4；

第二层：

0号房间，无楼梯通往上层，指示牌上的数字是1；

1号房间，有楼梯通往上层，指示牌上的数字是5；

2号房间，有楼梯通往上层，指示牌上的数字是2；

美国队长首先进入第一层（底层）的1号房间，记下指示牌上的数字为3，

然后从这个房间开始，沿逆时针方向选择第3个有楼梯的房间2号房间进入，

上楼后到达第二层的2号房间，记下指示牌上的数字为2，

由于当前房间本身有楼梯通向上层，该房间作为第一个有楼梯的房间。

因此，此时沿逆时针方向选择第2个有楼梯的房间即为1号房间，进入后上楼梯到达顶层。

这时把上述记下的指示牌上的数字加起来，即3+2=5，所以打开保险柜的密钥就是5。


#### 数据范围
对于 50% 数据，有 0 < N ≤ 1000, 0 < x ≤ 10000；
对于 100% 数据，有 0 < N ≤ 10000,0 < M ≤ 100,0 < x ≤ 1,000,000 。
